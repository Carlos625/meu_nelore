import{r,u as z,e as I,j as s,L as _,F as T,a as C}from"./index-COgq7w1N.js";import{g as U}from"./firestore-DFEv3qpL.js";import{F as G,a as q}from"./PlusIcon-CN4udwoI.js";const p=10;function O(){const[A,E]=r.useState([]),[D,b]=r.useState(!0),[u,k]=r.useState(""),[x,j]=r.useState("todos"),[f,B]=r.useState(""),[h,L]=r.useState(""),[o,i]=r.useState(1),[v]=z(),P=I();r.useEffect(()=>{var t;const e=(t=v.get("status"))==null?void 0:t.toLowerCase();e&&["ativo","vendido","abatido","morto"].includes(e)&&j(e),F()},[v]);async function F(){try{b(!0);const e=await U();E(e)}catch(e){console.error("Erro ao carregar dados:",e)}finally{b(!1)}}const y=[{id:"amarelo",nome:"Amarelo",cor:"bg-yellow-400"},{id:"verde",nome:"Verde",cor:"bg-green-500"},{id:"azul",nome:"Azul",cor:"bg-blue-500"},{id:"vermelho",nome:"Vermelho",cor:"bg-red-500"}],w=[{id:"ativo",nome:"Ativo",cor:"bg-green-500"},{id:"vendido",nome:"Vendido",cor:"bg-blue-500"},{id:"abatido",nome:"Abatido",cor:"bg-red-500"},{id:"morto",nome:"Morto",cor:"bg-gray-500"}],N=A.filter(e=>{var S;if(!e)return!1;const t=String(e.numeroBrinco||""),c=typeof e.raca=="string"?e.raca.toLowerCase():"",l=u.toLowerCase(),m=t.includes(u)||c.includes(l),a=x==="todos"||e.status===x;let n;try{e.dataEntrada instanceof Date?n=e.dataEntrada:(S=e.dataEntrada)!=null&&S.toDate?n=e.dataEntrada.toDate():typeof e.dataEntrada=="string"?n=new Date(e.dataEntrada):n=new Date}catch{n=new Date}const M=!f||n>=new Date(f),V=!h||n<=new Date(h);return m&&a&&M&&V}),d=Math.ceil(N.length/p),$=N.slice((o-1)*p,o*p);function R(e){j(e),i(1);const t=new URLSearchParams(window.location.search);e==="todos"?t.delete("status"):t.set("status",e),P({search:t.toString()},{replace:!0})}function g(e){e>=1&&e<=d&&i(e)}return D?s.jsx(_,{}):s.jsxs("div",{children:[s.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center",children:[s.jsx(T,{className:"h-8 w-8 text-primary-600 mr-3"}),s.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Animais"})]}),s.jsxs(C,{to:"/animais/novo",className:"mt-3 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[s.jsx(G,{className:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),"Novo Animal"]})]}),s.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4",children:[s.jsx("div",{className:"flex-1",children:s.jsxs("div",{className:"relative rounded-md shadow-sm",children:[s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:s.jsx(q,{className:"h-5 w-5 text-gray-400"})}),s.jsx("input",{type:"text",value:u,onChange:e=>{k(e.target.value),i(1)},className:"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-md sm:text-sm",placeholder:"Buscar por brinco ou raça"})]})}),s.jsx("div",{className:"w-full sm:w-48",children:s.jsxs("select",{value:x,onChange:e=>R(e.target.value),className:"block w-full pl-3 pr-10 py-3 text-base border-gray-300 sm:text-sm rounded-md",children:[s.jsx("option",{value:"todos",children:"Todos os Status"}),s.jsx("option",{value:"ativo",children:"Ativos"}),s.jsx("option",{value:"vendido",children:"Vendidos"}),s.jsx("option",{value:"abatido",children:"Abatidos"}),s.jsx("option",{value:"morto",children:"Mortos"})]})}),s.jsxs("div",{className:"flex justify-center gap-2 items-end mt-2",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Data inicial"}),s.jsx("input",{type:"date",value:f,onChange:e=>{B(e.target.value),i(1)},className:"block w-full px-2 py-2 border border-gray-300 rounded-md text-xs"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-xs font-medium text-gray-700",children:"Data final"}),s.jsx("input",{type:"date",value:h,onChange:e=>{L(e.target.value),i(1)},className:"block w-full px-2 py-2 border border-gray-300 rounded-md text-xs"})]})]})]}),s.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:s.jsx("ul",{className:"divide-y divide-gray-200",children:$.map(e=>{var t,c,l,m;return s.jsx("li",{children:s.jsx(C,{to:`/animais/${e.id}`,className:"block hover:bg-gray-50",children:s.jsx("div",{className:"px-4 py-4 sm:px-6",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center",children:[e.foto?s.jsx("img",{src:e.foto,alt:`Animal ${e.numeroBrinco}`,className:"h-12 w-12 rounded-full object-cover"}):s.jsx("div",{className:"h-12 w-12 rounded-full bg-gray-200 flex items-center justify-center",children:s.jsx("span",{className:"text-gray-500 text-lg font-medium",children:e.numeroBrinco})}),s.jsxs("div",{className:"ml-4",children:[s.jsxs("p",{className:"text-sm font-medium text-primary-600 flex items-center gap-2",children:["Brinco ",e.numeroBrinco,s.jsx("span",{className:`inline-block w-3 h-3 rounded-full ${((t=y.find(a=>a.id===e.corBrinco))==null?void 0:t.cor)||"bg-gray-300"}`,title:e.corBrinco}),s.jsx("span",{className:"text-xs text-gray-500 capitalize",children:((c=y.find(a=>a.id===e.corBrinco))==null?void 0:c.nome)||""})]}),s.jsx("p",{className:"text-sm text-gray-500",children:e.raca||""})]})]}),s.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:s.jsx("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${((l=w.find(a=>a.id===e.status.toLowerCase()))==null?void 0:l.cor)||"bg-gray-300"}`,children:((m=w.find(a=>a.id===e.status.toLowerCase()))==null?void 0:m.nome)||"Status Desconhecido"})})]})})})},e.id)})})}),d>1&&s.jsxs("div",{className:"mt-4 flex justify-center gap-2",children:[s.jsx("button",{onClick:()=>g(o-1),disabled:o===1,className:"px-3 py-1 text-sm border rounded disabled:opacity-50",children:"Anterior"}),Array.from({length:d},(e,t)=>s.jsx("button",{onClick:()=>g(t+1),className:`px-3 py-1 text-sm border rounded ${o===t+1?"bg-primary-600 text-white":""}`,children:t+1},t+1)),s.jsx("button",{onClick:()=>g(o+1),disabled:o===d,className:"px-3 py-1 text-sm border rounded disabled:opacity-50",children:"Próxima"})]})]})}export{O as default};
