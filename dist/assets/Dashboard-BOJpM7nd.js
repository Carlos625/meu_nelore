import{r as t,j as e,T as w,L,F as I,a as x,b as F,c as q,d as O}from"./index-COgq7w1N.js";import{g as Q,a as R,b as z,c as P,A as b,u as U}from"./firestore-DFEv3qpL.js";function W({isOpen:u,onClose:d,onSave:i,quantidadeAtual:g}){const[l,f]=t.useState(g);if(!u)return null;const n=c=>{c.preventDefault(),i(l),d()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Ajustar Quantidade de Brincos"}),e.jsxs("form",{onSubmit:n,children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantidade Total de Brincos"}),e.jsx("input",{type:"number",value:l,onChange:c=>f(Number(c.target.value)),className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500",min:"0",required:!0})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:d,className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700",children:"Salvar"})]})]})]})})}const H=()=>{const[u,d]=t.useState(!0),[i,g]=t.useState({totalAnimais:0,totalEntradas:0,totalSaidas:0,totalBrincoDisponivel:0,totalAnimaisVacinados:0}),[l,f]=t.useState(""),[n,c]=t.useState(""),[k,S]=t.useState([]),[,A]=t.useState(0),[B,v]=t.useState(!1),[D,j]=t.useState(300);t.useEffect(()=>{y()},[l,n]);const y=async()=>{d(!0);try{const[s,o,m,r]=await Promise.all([Q(),R(),z(),P()]);j((r==null?void 0:r.quantidadeTotalBrinco)||300);const p=s.filter(a=>{const h=a.dataEntrada instanceof w?a.dataEntrada.toDate():a.dataEntrada,C=!l||h>=new Date(l),M=!n||h<=new Date(n);return C&&M&&a.status===b.ATIVO}),N=p.filter(a=>o.some(h=>h.animalBrinco===a.numeroBrinco)).length,V=p.length,E=s.filter(a=>a.status!==b.ATIVO).length;g({totalAnimais:p.length,totalEntradas:V,totalSaidas:E,totalBrincoDisponivel:((r==null?void 0:r.quantidadeTotalBrinco)||300)-s.filter(a=>a.status===b.ATIVO).length,totalAnimaisVacinados:N}),A(N),S(m.slice(-5).reverse())}catch(s){console.error("Erro ao carregar dados:",s)}finally{d(!1)}},T=async s=>{try{await U({quantidadeTotalBrinco:s}),j(s),y()}catch(o){console.error("Erro ao salvar quantidade de brincos:",o)}};return u?e.jsx(L,{}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx("img",{src:"/Nelore.png",alt:"Logo Meu Nelore",className:"w-14 h-14 rounded-full shadow"}),e.jsx("h2",{className:"text-4xl sm:text-5xl font-extrabold text-gray-900 tracking-tight leading-tight drop-shadow-sm",children:"Dashboard"})]})}),e.jsx("p",{className:"mt-2 text-lg text-gray-500 font-light",children:"Visão geral do seu rebanho"}),e.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-4 items-center bg-white/80 rounded-xl shadow-sm px-4 py-3 w-full max-w-lg",children:[e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Data inicial"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:l,onChange:s=>f(s.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition",placeholder:"Data inicial"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3.75 7.5h16.5M4.5 21h15a.75.75 0 00.75-.75V7.5a.75.75 0 00-.75-.75h-15a.75.75 0 00-.75.75v12.75c0 .414.336.75.75.75z"})})})]})]}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsx("label",{className:"block text-xs font-semibold text-gray-600 mb-1",children:"Data final"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"date",value:n,onChange:s=>c(s.target.value),className:"block w-full px-3 py-2 border border-gray-300 rounded-lg shadow-sm text-sm focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition",placeholder:"Data final"}),e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 pointer-events-none",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.75 3v2.25M17.25 3v2.25M3.75 7.5h16.5M4.5 21h15a.75.75 0 00.75-.75V7.5a.75.75 0 00-.75-.75h-15a.75.75 0 00-.75.75v12.75c0 .414.336.75.75.75z"})})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4 mb-10",children:[e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-white shadow-lg rounded-2xl transition-transform hover:-translate-y-1 hover:shadow-2xl",children:[e.jsxs("div",{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-green-100 rounded-full p-3",children:e.jsx(I,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Total de Animais"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:i.totalAnimais})]})]}),e.jsx("div",{className:"bg-green-50 px-6 py-3 rounded-b-2xl",children:e.jsx(x,{to:"/animais",className:"font-medium text-green-700 hover:text-green-900 transition",children:"Ver todos"})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-white shadow-lg rounded-2xl transition-transform hover:-translate-y-1 hover:shadow-2xl",children:[e.jsxs("div",{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-100 rounded-full p-3",children:e.jsx(F,{className:"h-8 w-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Total Entradas"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:i.totalEntradas})]})]}),e.jsx("div",{className:"bg-blue-50 px-6 py-3 rounded-b-2xl",children:e.jsx(x,{to:"/animais?status=Ativo",className:"font-medium text-blue-700 hover:text-blue-900 transition",children:"Ver detalhes"})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-white shadow-lg rounded-2xl transition-transform hover:-translate-y-1 hover:shadow-2xl",children:[e.jsxs("div",{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-yellow-100 rounded-full p-3",children:e.jsx(q,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Total Saídas"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:i.totalSaidas})]})]}),e.jsx("div",{className:"bg-yellow-50 px-6 py-3 rounded-b-2xl",children:e.jsx(x,{to:"/animais?status=Vendido",className:"font-medium text-yellow-700 hover:text-yellow-900 transition",children:"Ver detalhes"})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-teal-50 to-white shadow-lg rounded-2xl transition-transform hover:-translate-y-1 hover:shadow-2xl cursor-pointer",onClick:()=>v(!0),children:[e.jsxs("div",{className:"p-6 flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0 bg-teal-100 rounded-full p-3",children:e.jsx(O,{className:"h-8 w-8 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-500 uppercase",children:"Brincos Disponíveis"}),e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:i.totalBrincoDisponivel})]})]}),e.jsx("div",{className:"bg-teal-50 px-6 py-3 rounded-b-2xl",children:e.jsx("span",{className:"font-medium text-teal-700 hover:text-teal-900 transition",children:"Clique para ajustar"})})]})]}),e.jsx(W,{isOpen:B,onClose:()=>v(!1),onSave:T,quantidadeAtual:D}),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Últimos Incidentes"}),e.jsx(x,{to:"/incidentes",className:"mt-3 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition",children:"Ver todos os incidentes"})]}),e.jsx("div",{className:"bg-white shadow-lg rounded-xl overflow-hidden",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:k.map(s=>{var o,m,r;return e.jsx("li",{children:e.jsxs(x,{to:`/incidentes/${s.id}`,className:"block hover:bg-gray-50 transition",children:[e.jsxs("div",{className:"px-4 py-4 sm:px-6 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:"ml-4",children:[e.jsxs("p",{className:"text-sm font-semibold text-primary-600",children:["Animal #",((o=s.animalBrinco)==null?void 0:o.toString())||"N/A"," - ",((m=s.tipo)==null?void 0:m.charAt(0).toUpperCase())+((r=s.tipo)==null?void 0:r.slice(1))||"N/A"]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.descricao||"Sem descrição"})]})}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex mt-2 sm:mt-0",children:e.jsx("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="resolvido"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status==="resolvido"?"Resolvido":"Pendente"})})]}),e.jsx("div",{className:"mt-2 sm:flex sm:justify-between px-4 pb-2",children:e.jsx("div",{className:"sm:flex",children:e.jsx("p",{className:"flex items-center text-xs text-gray-400",children:s.data instanceof w?s.data.toDate().toLocaleDateString():new Date(s.data).toLocaleDateString()})})})]})},s.id)})})})]})]})};export{H as default};
