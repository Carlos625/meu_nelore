import{r as o,j as e,a as x}from"./index-COgq7w1N.js";import{b as w,g as S}from"./firestore-DFEv3qpL.js";import{F as D,a as F}from"./PlusIcon-CN4udwoI.js";function I(t){return t?t instanceof Date?t:typeof(t==null?void 0:t.toDate)=="function"?t.toDate():typeof t.seconds=="number"?new Date(t.seconds*1e3):null:null}function k(){const[t,f]=o.useState([]),[m,p]=o.useState([]),[h,u]=o.useState(!0),[i,g]=o.useState(""),[n,j]=o.useState("todos"),[l,v]=o.useState("todos");o.useEffect(()=>{y()},[]);async function y(){try{u(!0);const[s,r]=await Promise.all([w(),S()]);f(s),p(r)}catch(s){console.error("Erro ao carregar dados:",s)}finally{u(!1)}}const b=t.filter(s=>{const r=m.find(N=>String(N.id)===String(s.animalId)),c=r&&(r.numeroBrinco.toString().includes(i)||s.descricao.toLowerCase().includes(i.toLowerCase())),a=n==="todos"||s.status===n,d=l==="todos"||s.tipo===l;return c&&a&&d});return h?e.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{children:[e.jsxs("div",{className:"sm:flex sm:items-center sm:justify-between mb-6",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Incidentes"}),e.jsxs(x,{to:"/incidentes/novo",className:"mt-3 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-primary-600 hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500",children:[e.jsx(D,{className:"-ml-1 mr-2 h-5 w-5","aria-hidden":"true"}),"Novo Incidente"]})]}),e.jsxs("div",{className:"mb-6 grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"relative rounded-md shadow-sm",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(F,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})}),e.jsx("input",{type:"text",value:i,onChange:s=>g(s.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-primary-500 focus:border-primary-500 sm:text-sm",placeholder:"Buscar por brinco ou descrição"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("select",{value:n,onChange:s=>j(s.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"todos",children:"Todos os Status"}),e.jsx("option",{value:"pendente",children:"Pendente"}),e.jsx("option",{value:"resolvido",children:"Resolvido"})]}),e.jsxs("select",{value:l,onChange:s=>v(s.target.value),className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-primary-500 focus:border-primary-500 sm:text-sm rounded-md",children:[e.jsx("option",{value:"todos",children:"Todos os Tipos"}),e.jsx("option",{value:"doenca",children:"Doença"}),e.jsx("option",{value:"acidente",children:"Acidente"}),e.jsx("option",{value:"outro",children:"Outro"})]})]})]}),e.jsx("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:e.jsx("ul",{className:"divide-y divide-gray-200",children:b.map(s=>{var a;const r=m.find(d=>d.id===s.animalId.toString()),c=((a=I(s.data))==null?void 0:a.toLocaleDateString("pt-BR"))||"Data inválida";return e.jsx("li",{children:e.jsx(x,{to:`/incidentes/${s.id}`,className:"block hover:bg-gray-50",children:e.jsxs("div",{className:"px-4 py-4 sm:px-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[s.foto?e.jsx("img",{src:s.foto,alt:"Foto do incidente",className:"h-12 w-12 rounded-lg object-cover"}):e.jsx("div",{className:"h-12 w-12 rounded-lg bg-gray-200 flex items-center justify-center",children:e.jsx("span",{className:"text-gray-500 text-lg font-medium",children:(r==null?void 0:r.numeroBrinco)||"N/A"})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("p",{className:"text-sm font-medium text-primary-600",children:["Animal #",(r==null?void 0:r.numeroBrinco)||s.animalId," - ",typeof s.tipo=="string"?s.tipo.charAt(0).toUpperCase()+s.tipo.slice(1):"Tipo não informado"]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.descricao||"Sem descrição"})]})]}),e.jsx("div",{className:"ml-2 flex-shrink-0 flex",children:e.jsx("p",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="resolvido"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:typeof s.status=="string"?s.status==="resolvido"?"Resolvido":"Pendente":"Status Desconhecido"})})]}),e.jsx("div",{className:"mt-2 sm:flex sm:justify-between",children:e.jsx("p",{className:"text-sm text-gray-500",children:c})}),s.observacoes&&e.jsx("div",{className:"mt-2",children:e.jsx("p",{className:"text-sm text-gray-500",children:s.observacoes})})]})})},s.id)})})})]})}export{k as default};
